"use strict";var Rolepath={roleid:null,init:function(){$q("#rolepath .form-wrapper").html("");Rolepath.view.render();var a={onDelete:function(b){if(b.length>0){Aero.confirm({ok:"un-link",title:"Removing Path links",msg:"Are you sure you want to un-link "+b.length+" items?",onConfirm:function(){Rolepath.api.del(b)}})}}};new Utils.menu("#menuPath",a)}};Rolepath.model={url:"api/pathwayrolemap",defaults:function(){return{title:"",description:""}},save:function(){var a=$q("form").aeroSerialize();Rolepath.api.create(a.pathwayid)}};Rolepath.view={table:null,render:function(){var a="pathwayrolemap/table?roleid="+Rolemap.roleid;var b=[{width:"5%",sClass:"center"},{width:"30%"},{width:"50%"},{width:"5%",sClass:"center"},{width:"10%",sClass:"tright"}];this.table=new Utils.datatable(a,b,"rolepath");this.setEvents()},renderForm:function(){var a=this;Aero.tpl.get("rolepath-form.html",function(b){Rolepath.api.getPathways(function(){var c=_q.template(b);Aero.confirm({ok:"Save",title:"Associate to this role",msg:c({paths:Rolepath.PATHWAYS}),onConfirm:function(){Rolepath.model.save()}})})})},setEvents:function(){$q("#rolepath .form-wrapper").off("keypress.pkey").on("keypress.pkey",function(b){var a=b.keyCode||b.which;if(a=="13"){Rolepath.model.save()}});$q("#rolepath .add").off("click.pa").on("click.pa",function(){Rolepath.view.renderForm();return false});$q("body").off("click.pd").on("click.pd","#rolepath .delete",function(){var b=$q(this).parents("div:eq(0)").data("id");var a=$q(this).parents("tr:eq(0)").find("td:eq(1)").text();Aero.confirm({ok:"un-link",title:a,msg:"Are you sure you want to un-link this path?",onConfirm:function(){Rolepath.api.del(b)}});return false});$q("#rolepath .save").off("click.ps").on("click.ps",function(){Rolepath.model.save();return false});$q(".cancel").off("click.pc").on("click.pc",function(){$q("#rolepath .form-wrapper").html("");return false})}};Rolepath.api={getPathways:function(a){if(Rolepath.PATHWAYS){a(Rolepath.PATHWAYS);return}Aero.send("api/pathway",{},function(b){Rolepath.PATHWAYS=b;a()},"GET")},create:function(a){var b={roleid:Rolemap.roleid,pathwayid:a};Aero.send(Rolepath.model.url,b,function(c){Rolepath.view.table.ajax.reload();$q(".form-wrapper").html("")},"POST")},del:function(a){Aero.log("Deleting with guideid: "+a,"info");var b={roleid:Rolemap.roleid,pathwayid:a};Aero.send(Rolepath.model.url,b,function(c){Rolepath.view.table.ajax.reload();$q(".form-wrapper").html("")},"DELETE")}};