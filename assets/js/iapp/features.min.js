"use strict";require(["aero"],function(){var a={id:null,init:function(){$q("#form-wrapper").html("");a.view.render();var b={onDelete:function(c){if(c.length>0){Aero.confirm({ok:"Delete",title:"Deleting",msg:"You are about to delete <strong>"+c.length+"</strong> item(s)</strong>?",onConfirm:function(){a.api.del(c)}})}}};new Utils.menu("#menu",b)}};a.model={url:"api/features",defaults:function(){return{title:"",description:""}},validate:function(){return $q("form").isFormValid()},save:function(){var b=$q("form").aeroSerialize();b.active=(b.active)?true:false;if(a.id){a.api.update(b,a.id)}else{a.api.create(b)}}};a.view={table:null,render:function(){var b="features/table";var c=[{width:"5%",sClass:"center"},{width:"25%"},{width:"25%"},{width:"10%",sClass:"center"},{width:"20%"},{width:"5%",sClass:"tright"}];this.table=new Utils.datatable(b,c);this.setEvents()},renderForm:function(b){Aero.tpl.get("feature-form.html",function(d){a.id=(b)?b.id:null;if(!b){b={}}var c=_q.template(d);Aero.confirm({ok:"save",title:"Feature Information",msg:c({feature:b}),onValidate:function(){return a.model.validate()},onConfirm:function(){a.model.save()}})})},setEvents:function(){$q("body").off("keypress.sn").on("keypress.sn",function(c){var b=c.keyCode||c.which;if(c.target.tagName=="BODY"&&b=="78"&&c.shiftKey){a.view.renderForm()}});$q(".add").off("click.patha").on("click.patha",function(){a.view.renderForm();return false});$q("body").off("click.pathd").on("click.pathd",".delete",function(){var c=$q(this).parents("div:eq(0)").data("id");var b=$q(this).parents("tr").find("td:eq(1)").text();Aero.confirm({ok:"Delete",title:b,msg:"Are you sure you want to delete this?",onConfirm:function(){a.api.del(c)}});return false});$q("body").off("click.pathe").on("click.pathe",".edit",function(){var b=$q(this).parents("div:eq(0)").data("id");a.api.get(function(c){a.view.renderForm(c)},b);return false});$q("body").off("click.pathf").on("click.pathf",".trash",function(){window.location.href="/app/"+AeroStep.host+"/trash";return false})}};a.api={get:function(d,c){var b={};if(c){b={id:c}}Aero.send(a.model.url,b,function(e){if(d){d(e)}},"GET")},create:function(b){Aero.send(a.model.url,b,function(){a.view.table.ajax.reload()},"POST")},clone:function(b){Aero.send(a.model.url+"/clone",{id:b},function(){a.view.table.ajax.reload()},"POST")},update:function(b,d,c){b.id=d;Aero.send(a.model.url,b,function(e){a.view.table.ajax.reload();if(c){c(e)}},"PUT")},del:function(b){Aero.send(a.model.url,{id:b},function(){a.view.table.ajax.reload()},"DELETE")}};$q(function(){a.init()})});