"use strict";Aero.model.pathway={url:"api/pathway"};Aero.view.pathway={render:function(a,b){$q(".aero-here").remove();try{var d=a[b].title;var e=a[b].id;if(b==0){Aero.guide.getAll(function(f){Aero.view.guide.render(f)})}else{if(b==a.length-1){Aero.onpage.getGuides(function(f){f[0].path="On This Page";Aero.view.guide.render(f)})}else{Aero.pathway.getGuides(e,function(f){f[0].path=d;f[0].pathid=e;Aero.view.guide.render(f)})}}aeroStorage.setItem("aero:pathway",b);aeroStorage.setItem("aero:pathway:name",d);return true}catch(c){return false}},setEvents:function(){var a=this;$q("body").off("click.aeropath").on("click.aeropath",'.aero-carousel a:not(".aero-share")',function(){var b=$q(this).hasClass("aero-left");Aero.pathway.get(function(f){var g=null;var c=aeroStorage.getItem("aero:pathway");var e=f.length-1;var d=c?c:0;if(b){d--}else{d++}if(d<0){d=e}if(d>e){d=0}a.render(f,d)});return false})}};Aero.pathway={init:function(){Aero.view.pathway.setEvents()},get:function(c,b){if(Aero.constants.PATHWAYS){c(Aero.constants.PATHWAYS);return}var a={};a.dropEmpty=true;a.count=true;a.select=["title"];if(b){a={id:b}}Aero.send(Aero.model.pathway.url,a,function(d){d.unshift({title:AeroStep.lang.allguides});d.push({title:"On This Page"});Aero.constants.PATHWAYS=d;if(c){c(d)}},"GET")},getGuides:function(a,b){if(!Aero.constants.pathway){Aero.constants.pathway={}}if(Aero.constants.pathway&&Aero.constants.pathway[a]){b(Aero.constants.pathway[a]);return}Aero.send("api/pathwaymap/by_pathway",{active:true,pathwayid:a},function(c){Aero.constants.pathway[a]=c;if(b){b(c)}},"GET")}};Aero.onpage={getGuides:function(d){var c=this;var a=[];var b=d;Aero.guide.getAll(function(f){for(var e in f){var g=f[e].step[0];if(g){if(g.position&&g.position=="orphan"){g=f[e].step[1]}if(g.loc=="body"){break}if(g.noUrl=="all"||g.url==window.location.pathname){a.push(f[e])}}}c.render(a);if(d){d(a)}})},render:function(d){var f=0;for(var b in d){var e,a,g,c;e=d[b].step[0];if(e.position&&e.position=="orphan"){e=d[b].step[1]}a=$q(e.loc);g=a.offset();a.addClass("ae-here").data("ae-id",f);c=$q('<a id="ae-id-'+f+'" class="aero-here">X</a>');c.css({top:g.top-20,left:g.left-37}).data("guideids",d[b].id);f++;$q("body").append(c);this.setEvents()}},setEvents:function(){$q(".aero-here").off("click.aeop").on("click.aeop",function(){Aero.tip.start($q(this).data("guideids"));$q(".aero-here").remove()})}};