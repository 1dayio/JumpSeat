"use strict";var Aero={constants:{PATH:AeroStep.baseUrl,USERNAME:AeroStep.getUsername()},model:{},view:{},host:AeroStep.host,send:function(b,d,e,c){if(!c){c="GET"}if(!d.host){d.host=this.host}if(c=="POST"||c=="PUT"){d=JSON.stringify(d)}b=this.constants.PATH+b;var a={async:false,type:c,data:d,dataType:"json",contentType:"application/json",url:b,success:function(f){if(e){e(f)}},error:function(h,g){var f=b+" says: "+JSON.stringify(h)+" "+JSON.stringify(g);Aero.log(JSON.stringify(f))}};if(c=="GET"){a.dataType="jsonp"}$q.ajax(a)},log:function(b,a){if(!AeroStep.debug){return}if(a){switch(a){case"error":console.log("%c"+b,"background: #ea8181; color: #333");break;case"warn":console.log("%c"+b,"background: #eac481; color: #333");break;case"success":console.log("%c"+b,"background: #8eea81; color: #333");break;case"info":console.log("%c"+b,"background: #81d7ea; color: #333");break}}else{console.log(b)}}};Aero.confirm=function(d){var c;var g={ok:AeroStep.lang.ok,cancel:AeroStep.lang.cancel,title:"",msg:"",confirm:false,onConfirm:function(){},onCancel:function(){},onValidate:function(){return true}};$q.extend(g,d);function b(){Aero.tpl.get("modal.html",function(i){var h=_q.template(i);$q("body").append(h({msg:g}));c=$q(".aero-modal").hide();g.height=c.outerHeight();c.css({top:($q(window).height()/2)-(g.height/2),left:($q(window).width()/2)-(c.outerWidth()/2)});$q(".aero-backdrop").fadeTo(200,0.5,function(){c.show();$q(".aero-modal-body").find("input:eq(0)").focus()});f(g.onConfirm)})}function e(){c=$q(".aero-modal");c.animate({top:-(g.height)},300,function(){$q(".aero-backdrop, .aero-modal").fadeTo(200,0).remove()})}function a(){if(g.onValidate()){g.onConfirm();e()}}function f(){$q("body").off("keyup.smw").on("keyup.smw",function(i){var h=i.keyCode||i.which;if(h=="27"){g.onCancel();e()}});$q("body").off("click.confok").on("click.confok",".aero-btn-ok",function(){a()});$q("body").off("click.confc").on("click.confc",".aero-btn-no",function(){g.onCancel();e()});$q(".aero-modal").off("keypress.confk").on("keypress.confk",function(i){var h=i.keyCode||i.which;if(h=="13"){a();return false}})}b()};Aero.tpl={templates:{},get:function(b,e){var a=this;var d="api/template";var c={name:b,guest:Aero.constants.USERNAME};if(a.templates[b]){if(e){e(a.templates[b])}return}Aero.send(d,c,function(f){var g=JSON.parse(f);Aero.tpl.templates[b]=g.tpl;if(e){e(a.templates[b])}})}};$q.fn.aeroSerialize=function(){var c={};var b=this.serializeArray();$q.each(b,function(){var a=this.name.replace("aero_","");if(c[a]!==undefined){if(!c[a].push){c[a]=[c[this.name]]}c[a].push(this.value||"")}else{c[a]=this.value||""}});return c};$q.fn.isFormValid=function(){var a=[];$q(".aero-require-error").removeClass("aero-require-error");$q(".aero-error-box").remove();$q(this).find(".aero-required").each(function(){$q(this).removeClass("aero-require-error");if($q(this).val()==""){if(a.length==0){a.push(AeroStep.lang.requirede)}$q(this).addClass("aero-require-error")}});if(a.length>0){if($q(".aero-modal form:eq(0)").length>0){$q(".aero-modal form:eq(0)").prepend('<div class="aero-error-box"><ul><li>'+a.join("</li><li>")+"</li></ul></div>")}return false}return true};$q.fn.visible=function(k){var d=$q(window);var g=this.length>1?this.eq(0):this,m=g.get(0),f=d.width(),l=d.height();if(typeof m.getBoundingClientRect==="function"){var e=m.getBoundingClientRect(),i=e.top>=0&&e.top<l,c=e.bottom>0&&e.bottom<=l,j=e.left>=0&&e.left<f,a=e.right>0&&e.right<=f,h=k?i||c:i&&c,b=k?j||a:j&&a;return h&&b}};(function(b){var a=b.fn.on,c;b.fn.on=function(){var e=Array.apply(null,arguments);var g=e[e.length-1];if(isNaN(g)||(g===1&&e.pop())){return a.apply(this,e)}var d=e.pop();var f=e.pop();e.push(function(){var h=this,i=arguments;clearTimeout(c);c=setTimeout(function(){f.apply(h,i)},d)});return a.apply(this,e)}}(this.$q));if(!Object.keys){Object.keys=function(c){var b=[];for(var a in c){if(c.hasOwnProperty(a)){b.push(a)}}return b}}if(typeof aerofire!=="undefined"){aerofire.init()};